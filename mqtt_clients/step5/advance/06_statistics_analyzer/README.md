# å¿œç”¨ä¾‹6ï¼šçµ±è¨ˆåˆ†æãƒ„ãƒ¼ãƒ«

## ğŸ“Š æ¦‚è¦

åé›†ã—ãŸã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’çµ±è¨ˆçš„ã«åˆ†æã—ã€å¹³å‡ã€ä¸­å¤®å€¤ã€æ¨™æº–åå·®ãªã©ã‚’è¨ˆç®—ã—ã¦è¡¨ç¤ºã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

## ğŸ¯ å­¦ç¿’ç›®æ¨™

- ãƒ‡ãƒ¼ã‚¿ã®çµ±è¨ˆåˆ†ææ‰‹æ³•
- numpy/pandasã‚’ä½¿ã£ãŸé«˜åº¦ãªåˆ†æ
- ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–
- ãƒˆãƒ¬ãƒ³ãƒ‰æ¤œå‡º

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
06_statistics_analyzer/
â”œâ”€â”€ README.md               # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ statistics_analyzer.py  # çµ±è¨ˆåˆ†æãƒ„ãƒ¼ãƒ«
```

## ğŸš€ å®Ÿè¡Œæ–¹æ³•

### 1. å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pip install numpy matplotlib
```

### 2. çµ±è¨ˆåˆ†æãƒ„ãƒ¼ãƒ«ã®èµ·å‹•

```bash
python mqtt_clients/step5/advance/06_statistics_analyzer/statistics_analyzer.py
```

### 3. ã‚»ãƒ³ã‚µãƒ¼ã®èµ·å‹•ï¼ˆåˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰

```bash
python mqtt_clients/step5/advance/03_realistic_sensor/realistic_sensor_publisher.py
```

## âœ¨ ä¸»ãªæ©Ÿèƒ½

### åŸºæœ¬çµ±è¨ˆ
- âœ… **å¹³å‡å€¤**: ãƒ‡ãƒ¼ã‚¿ã®ä¸­å¿ƒå‚¾å‘
- âœ… **ä¸­å¤®å€¤**: å¤–ã‚Œå€¤ã«å¼·ã„ä¸­å¿ƒå€¤
- âœ… **æ¨™æº–åå·®**: ãƒ‡ãƒ¼ã‚¿ã®ã°ã‚‰ã¤ã
- âœ… **æœ€å¤§å€¤/æœ€å°å€¤**: ãƒ‡ãƒ¼ã‚¿ã®ç¯„å›²
- âœ… **ç¯„å›²**: æœ€å¤§å€¤ã¨æœ€å°å€¤ã®å·®

### é«˜åº¦ãªçµ±è¨ˆ
- âœ… **ç§»å‹•å¹³å‡**: ãƒˆãƒ¬ãƒ³ãƒ‰ã®æŠŠæ¡
- âœ… **ãƒˆãƒ¬ãƒ³ãƒ‰æ¤œå‡º**: ä¸Šæ˜‡/ä¸‹é™å‚¾å‘ã®åˆ¤å®š
- âœ… **å¤‰å‹•ä¿‚æ•°**: ç›¸å¯¾çš„ãªã°ã‚‰ã¤ã
- âœ… **å››åˆ†ä½æ•°**: ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒ

## ğŸ“Š çµ±è¨ˆæƒ…å ±ã®è¨ˆç®—

### åŸºæœ¬çµ±è¨ˆé‡

```python
import numpy as np

def analyze_data(data):
    stats = {
        "å¹³å‡": np.mean(data),
        "ä¸­å¤®å€¤": np.median(data),
        "æ¨™æº–åå·®": np.std(data),
        "æœ€å¤§å€¤": np.max(data),
        "æœ€å°å€¤": np.min(data),
        "ç¯„å›²": np.max(data) - np.min(data)
    }
    return stats
```

### ç§»å‹•å¹³å‡

```python
def moving_average(data, window=10):
    """ç§»å‹•å¹³å‡ã‚’è¨ˆç®—"""
    return [
        sum(data[i:i+window])/window
        for i in range(len(data)-window+1)
    ]
```

### ãƒˆãƒ¬ãƒ³ãƒ‰æ¤œå‡º

```python
def detect_trend(data):
    """ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’æ¤œå‡º"""
    if len(data) < 10:
        return "ãƒ‡ãƒ¼ã‚¿ä¸è¶³"

    recent = sum(data[-5:]) / 5
    older = sum(data[-10:-5]) / 5

    if recent > older + 1:
        return "ä¸Šæ˜‡å‚¾å‘ â†—"
    elif recent < older - 1:
        return "ä¸‹é™å‚¾å‘ â†˜"
    else:
        return "å®‰å®š â†’"
```

## ğŸ“Š çµ±è¨ˆè¡¨ç¤ºä¾‹

```
==================================================
ğŸ“Š çµ±è¨ˆåˆ†æãƒ¬ãƒãƒ¼ãƒˆ
==================================================
ãƒ‡ãƒ¼ã‚¿å–å¾—æœŸé–“: 2025-11-11 15:00:00 ã€œ 2025-11-11 16:00:00
åˆ†æå¯¾è±¡: MultiSensor01

ã€æ¸©åº¦ãƒ‡ãƒ¼ã‚¿ã€‘
  ãƒ‡ãƒ¼ã‚¿æ•°: 3600
  å¹³å‡: 25.34 Â°C
  ä¸­å¤®å€¤: 25.20 Â°C
  æ¨™æº–åå·®: 1.85 Â°C
  æœ€å¤§å€¤: 31.50 Â°C
  æœ€å°å€¤: 18.20 Â°C
  ç¯„å›²: 13.30 Â°C
  ãƒˆãƒ¬ãƒ³ãƒ‰: ä¸Šæ˜‡å‚¾å‘ â†—

ã€æ¹¿åº¦ãƒ‡ãƒ¼ã‚¿ã€‘
  ãƒ‡ãƒ¼ã‚¿æ•°: 3600
  å¹³å‡: 52.18 %
  ä¸­å¤®å€¤: 51.90 %
  æ¨™æº–åå·®: 8.45 %
  æœ€å¤§å€¤: 68.90 %
  æœ€å°å€¤: 35.40 %
  ç¯„å›²: 33.50 %
  ãƒˆãƒ¬ãƒ³ãƒ‰: å®‰å®š â†’

ã€ç…§åº¦ãƒ‡ãƒ¼ã‚¿ã€‘
  ãƒ‡ãƒ¼ã‚¿æ•°: 3600
  å¹³å‡: 485.23 lux
  ä¸­å¤®å€¤: 480.00 lux
  æ¨™æº–åå·®: 125.67 lux
  æœ€å¤§å€¤: 890.00 lux
  æœ€å°å€¤: 120.00 lux
  ç¯„å›²: 770.00 lux
  ãƒˆãƒ¬ãƒ³ãƒ‰: ä¸‹é™å‚¾å‘ â†˜
==================================================
```

## ğŸ’¡ å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ

### 1. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿ã®è“„ç©

```python
from collections import deque

temp_data = deque(maxlen=3600)  # æœ€å¤§1æ™‚é–“åˆ†
```

### 2. å®šæœŸçš„ãªçµ±è¨ˆè¨ˆç®—

```python
import threading

def periodic_analysis():
    while running:
        analyze_and_print_stats()
        time.sleep(60)  # 1åˆ†ã”ã¨
```

### 3. ç•°å¸¸å€¤ã®é™¤å¤–

```python
def remove_outliers(data, threshold=3):
    """æ¨™æº–åå·®ã‚’ä½¿ã£ã¦ç•°å¸¸å€¤ã‚’é™¤å¤–"""
    mean = np.mean(data)
    std = np.std(data)
    return [x for x in data if abs(x - mean) < threshold * std]
```

## ğŸ”§ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¾‹

### ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®è¡¨ç¤º

```python
import matplotlib.pyplot as plt

def plot_histogram(data, title):
    plt.hist(data, bins=50, alpha=0.7)
    plt.title(title)
    plt.xlabel('å€¤')
    plt.ylabel('é »åº¦')
    plt.show()
```

### ç›¸é–¢åˆ†æ

```python
def analyze_correlation(temp_data, humid_data):
    """æ¸©åº¦ã¨æ¹¿åº¦ã®ç›¸é–¢ã‚’åˆ†æ"""
    import numpy as np

    correlation = np.corrcoef(temp_data, humid_data)[0, 1]
    print(f"æ¸©åº¦ã¨æ¹¿åº¦ã®ç›¸é–¢ä¿‚æ•°: {correlation:.3f}")

    if correlation > 0.7:
        print("å¼·ã„æ­£ã®ç›¸é–¢")
    elif correlation < -0.7:
        print("å¼·ã„è² ã®ç›¸é–¢")
    else:
        print("å¼±ã„ç›¸é–¢")
```

### æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆ

```python
def plot_time_series(timestamps, values):
    plt.plot(timestamps, values)
    plt.xlabel('æ™‚åˆ»')
    plt.ylabel('å€¤')
    plt.xticks(rotation=45)
    plt.tight_layout()
    plt.show()
```

## ğŸ“ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ

1. **çµ±è¨ˆã®åŸºç¤**: å¹³å‡ã€ä¸­å¤®å€¤ã€æ¨™æº–åå·®ã®æ„å‘³ã¨ä½¿ã„åˆ†ã‘
2. **numpy ã®æ´»ç”¨**: åŠ¹ç‡çš„ãªæ•°å€¤è¨ˆç®—
3. **ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ**: æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®å‚¾å‘æŠŠæ¡
4. **ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†**: ç•°å¸¸å€¤ã®é™¤å¤–
5. **å¯è¦–åŒ–**: ãƒ‡ãƒ¼ã‚¿ã‚’è¦–è¦šçš„ã«ç†è§£

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [../../study/step5/05_å¿œç”¨ã‚³ãƒ¼ãƒ‰é›†.md](../../../../study/step5/05_å¿œç”¨ã‚³ãƒ¼ãƒ‰é›†.md)
