# ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰é›†

## ğŸ® æ¥½ã—ãè©¦ã›ã‚‹å®Ÿè·µã‚³ãƒ¼ãƒ‰

ã™ãã«ã‚³ãƒ”ãƒšã—ã¦å‹•ã‹ã›ã‚‹ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’é›†ã‚ã¾ã—ãŸï¼
ã©ã‚“ã©ã‚“è©¦ã—ã¦ã€MQTTã‚’ä½“é¨“ã—ã¾ã—ã‚‡ã†ï¼

---

## ğŸ“Š ã‚µãƒ³ãƒ—ãƒ«1ï¼šãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ ªä¾¡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿

æ ªä¾¡ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å¤‰å‹•ã™ã‚‹æ§˜å­ã‚’è¦³å¯Ÿã§ãã¾ã™ã€‚

**stock_publisher.py**:
```python
import paho.mqtt.client as mqtt
import random
import time

BROKER = "localhost"
stocks = {
    "AAPL": 150.0,
    "GOOGL": 2800.0,
    "TSLA": 700.0
}

client = mqtt.Client()
client.connect(BROKER, 1883, 60)

print("ğŸ“ˆ æ ªä¾¡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’é–‹å§‹...")
print("-" * 50)

try:
    while True:
        for symbol, price in stocks.items():
            # -2%ã€œ+2%ã®ãƒ©ãƒ³ãƒ€ãƒ ãªå¤‰å‹•
            change = random.uniform(-0.02, 0.02)
            new_price = round(price * (1 + change), 2)
            stocks[symbol] = new_price

            message = f"{new_price}"
            client.publish(f"stock/{symbol}", message)
            print(f"ğŸ“Š {symbol}: ${new_price}")

        print("-" * 50)
        time.sleep(2)
except KeyboardInterrupt:
    client.disconnect()
```

**stock_monitor.py**:
```python
import paho.mqtt.client as mqtt

def on_message(client, userdata, msg):
    symbol = msg.topic.split('/')[1]
    price = float(msg.payload.decode())
    print(f"ğŸ’° {symbol}: ${price:,.2f}")

def on_connect(client, userdata, flags, rc):
    if rc == 0:
        print("ğŸ“¡ æ ªä¾¡ãƒ¢ãƒ‹ã‚¿ãƒ¼é–‹å§‹")
        client.subscribe("stock/#")

client = mqtt.Client()
client.on_connect = on_connect
client.on_message = on_message
client.connect("localhost", 1883, 60)
client.loop_forever()
```

---

## ğŸ² ã‚µãƒ³ãƒ—ãƒ«2ï¼šã‚µã‚¤ã‚³ãƒ­ã‚²ãƒ¼ãƒ 

2äººã§ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã£ã¦ã€å¤§ãã„æ•°å­—ãŒå‡ºãŸæ–¹ã®å‹ã¡ï¼

**dice_player1.py**:
```python
import paho.mqtt.client as mqtt
import random
import time

client = mqtt.Client("Player1")
client.connect("localhost", 1883, 60)

print("ğŸ² ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1ã§ã™")
input("Enterã‚­ãƒ¼ã§ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚Šã¾ã™...")

dice = random.randint(1, 6)
client.publish("game/dice/player1", str(dice))
print(f"ğŸ² ã‚ãªãŸã®å‡ºç›®: {dice}")

client.disconnect()
```

**dice_player2.py**:
```python
import paho.mqtt.client as mqtt
import random

player1_dice = None
player2_dice = None

def on_message(client, userdata, msg):
    global player1_dice, player2_dice

    if msg.topic == "game/dice/player1":
        player1_dice = int(msg.payload.decode())
        print(f"ğŸ² ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1ã®å‡ºç›®: {player1_dice}")

    if player1_dice and player2_dice:
        print("\n" + "=" * 50)
        if player2_dice > player1_dice:
            print("ğŸ‰ ã‚ãªãŸã®å‹ã¡ï¼")
        elif player2_dice < player1_dice:
            print("ğŸ˜¢ ã‚ãªãŸã®è² ã‘...")
        else:
            print("ğŸ¤ å¼•ãåˆ†ã‘ï¼")
        print("=" * 50)
        client.disconnect()

def on_connect(client, userdata, flags, rc):
    client.subscribe("game/dice/#")

client = mqtt.Client("Player2")
client.on_connect = on_connect
client.on_message = on_message
client.connect("localhost", 1883, 60)

print("ğŸ² ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2ã§ã™")
input("Enterã‚­ãƒ¼ã§ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚Šã¾ã™...")

player2_dice = random.randint(1, 6)
client.publish("game/dice/player2", str(player2_dice))
print(f"ğŸ² ã‚ãªãŸã®å‡ºç›®: {player2_dice}")

client.loop_forever()
```

---

## ğŸ’¬ ã‚µãƒ³ãƒ—ãƒ«3ï¼šç°¡æ˜“ãƒãƒ£ãƒƒãƒˆãƒ«ãƒ¼ãƒ 

**chat_client.py**:
```python
import paho.mqtt.client as mqtt
import threading

ROOM = "chat/lobby"

def on_message(client, userdata, msg):
    sender = msg.topic.split('/')[-1]
    message = msg.payload.decode()
    if sender != client._client_id.decode():
        print(f"\nğŸ’¬ {sender}: {message}")
        print("ã‚ãªãŸ> ", end="", flush=True)

def on_connect(client, userdata, flags, rc):
    client.subscribe(f"{ROOM}/#")

# ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›
username = input("ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›: ")
print(f"\nğŸ‘‹ ã‚ˆã†ã“ãã€{username}ã•ã‚“ï¼")
print("ğŸ’¬ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆ'quit'ã§çµ‚äº†ï¼‰\n")

client = mqtt.Client(username)
client.on_connect = on_connect
client.on_message = on_message
client.connect("localhost", 1883, 60)
client.loop_start()

try:
    while True:
        message = input("ã‚ãªãŸ> ")
        if message.lower() == "quit":
            break
        client.publish(f"{ROOM}/{username}", message)
except KeyboardInterrupt:
    pass

client.loop_stop()
client.disconnect()
print("\nğŸ‘‹ ãƒãƒ£ãƒƒãƒˆã‚’çµ‚äº†ã—ã¾ã—ãŸ")
```

**ä½¿ã„æ–¹**: è¤‡æ•°ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§èµ·å‹•ã—ã¦ã€ãƒãƒ£ãƒƒãƒˆã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼

---

## ğŸ  ã‚µãƒ³ãƒ—ãƒ«4ï¼šã‚¹ãƒãƒ¼ãƒˆãƒ›ãƒ¼ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿

å®¶ã®ä¸­ã®ãƒ‡ãƒã‚¤ã‚¹ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚

**smart_home_devices.py**:
```python
import paho.mqtt.client as mqtt

# ãƒ‡ãƒã‚¤ã‚¹ã®çŠ¶æ…‹
devices = {
    "light": "off",
    "ac": "off",
    "door": "locked"
}

def on_message(client, userdata, msg):
    device = msg.topic.split('/')[-1]
    command = msg.payload.decode()

    if device in devices:
        devices[device] = command

        if device == "light":
            emoji = "ğŸ’¡" if command == "on" else "ğŸŒ™"
            print(f"{emoji} ç…§æ˜ã‚’{command}ã«ã—ã¾ã—ãŸ")
        elif device == "ac":
            emoji = "â„ï¸" if command == "on" else "ğŸ”¥"
            print(f"{emoji} ã‚¨ã‚¢ã‚³ãƒ³ã‚’{command}ã«ã—ã¾ã—ãŸ")
        elif device == "door":
            emoji = "ğŸ”“" if command == "unlocked" else "ğŸ”’"
            print(f"{emoji} ãƒ‰ã‚¢ã‚’{command}ã«ã—ã¾ã—ãŸ")

        # çŠ¶æ…‹ã‚’è¿”ä¿¡
        client.publish(f"home/status/{device}", command)

def on_connect(client, userdata, flags, rc):
    print("ğŸ  ã‚¹ãƒãƒ¼ãƒˆãƒ›ãƒ¼ãƒ ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•")
    client.subscribe("home/control/#")

client = mqtt.Client("HomeDevices")
client.on_connect = on_connect
client.on_message = on_message
client.connect("localhost", 1883, 60)

print("â³ ã‚³ãƒãƒ³ãƒ‰ã‚’å¾…ã£ã¦ã„ã¾ã™...")
client.loop_forever()
```

**smart_home_controller.py**:
```python
import paho.mqtt.client as mqtt

def on_message(client, userdata, msg):
    device = msg.topic.split('/')[-1]
    status = msg.payload.decode()
    print(f"âœ… {device}ã®çŠ¶æ…‹: {status}")

def on_connect(client, userdata, flags, rc):
    client.subscribe("home/status/#")

client = mqtt.Client("Controller")
client.on_connect = on_connect
client.on_message = on_message
client.connect("localhost", 1883, 60)
client.loop_start()

print("ğŸ® ã‚¹ãƒãƒ¼ãƒˆãƒ›ãƒ¼ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼")
print("-" * 50)
print("ã‚³ãƒãƒ³ãƒ‰:")
print("  light on/off")
print("  ac on/off")
print("  door locked/unlocked")
print("  quit - çµ‚äº†")
print("-" * 50)

try:
    while True:
        command = input("\nã‚³ãƒãƒ³ãƒ‰> ").strip().split()
        if not command:
            continue

        if command[0] == "quit":
            break

        if len(command) == 2:
            device, action = command
            client.publish(f"home/control/{device}", action)
        else:
            print("âŒ ä½¿ã„æ–¹: <device> <action>")

except KeyboardInterrupt:
    pass

client.loop_stop()
client.disconnect()
print("\nğŸ‘‹ çµ‚äº†ã—ã¾ã—ãŸ")
```

---

## ğŸš— ã‚µãƒ³ãƒ—ãƒ«5ï¼šé…é”ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ 

**delivery_vehicle.py**:
```python
import paho.mqtt.client as mqtt
import random
import time

locations = [
    "å€‰åº«",
    "é«˜é€Ÿé“è·¯",
    "SAï¼ˆä¼‘æ†©ä¸­ï¼‰",
    "å¸‚è¡—åœ°",
    "é…é”å…ˆã‚¨ãƒªã‚¢",
    "é…é”å®Œäº†"
]

client = mqtt.Client("DeliveryVan01")
client.connect("localhost", 1883, 60)

print("ğŸšš é…é”è»Šä¸¡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿")
print("-" * 50)

for i, location in enumerate(locations):
    progress = int((i / (len(locations) - 1)) * 100)
    message = f"{location}|{progress}"

    client.publish("delivery/van01/location", message)
    print(f"ğŸ“ ç¾åœ¨åœ°: {location} ({progress}%)")

    time.sleep(2)

client.disconnect()
print("âœ… é…é”å®Œäº†ï¼")
```

**delivery_tracker.py**:
```python
import paho.mqtt.client as mqtt

def on_message(client, userdata, msg):
    data = msg.payload.decode().split('|')
    location = data[0]
    progress = int(data[1])

    # ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¡¨ç¤º
    bar_length = 20
    filled = int(bar_length * progress / 100)
    bar = "â–ˆ" * filled + "â–‘" * (bar_length - filled)

    print(f"\rğŸšš {location:20} [{bar}] {progress}%", end="", flush=True)

    if progress == 100:
        print("\nâœ… è·ç‰©ãŒé…é”ã•ã‚Œã¾ã—ãŸï¼")
        client.disconnect()

def on_connect(client, userdata, flags, rc):
    print("ğŸ“¡ é…é”ãƒˆãƒ©ãƒƒã‚«ãƒ¼é–‹å§‹")
    client.subscribe("delivery/#")

client = mqtt.Client("Tracker")
client.on_connect = on_connect
client.on_message = on_message
client.connect("localhost", 1883, 60)
client.loop_forever()
```

---

## ğŸ“ˆ ã‚µãƒ³ãƒ—ãƒ«6ï¼šã‚»ãƒ³ã‚µãƒ¼ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆJSONä½¿ç”¨ï¼‰

**multi_sensor.py**:
```python
import paho.mqtt.client as mqtt
import random
import time
import json

client = mqtt.Client()
client.connect("localhost", 1883, 60)

print("ğŸ“Š è¤‡æ•°ã‚»ãƒ³ã‚µãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿")

try:
    while True:
        data = {
            "temperature": round(random.uniform(20, 30), 1),
            "humidity": round(random.uniform(40, 80), 1),
            "pressure": round(random.uniform(1000, 1020), 1)
        }

        # JSONã«å¤‰æ›ã—ã¦é€ä¿¡
        json_data = json.dumps(data)
        client.publish("sensors/data", json_data)

        print(f"ğŸ“¤ é€ä¿¡: æ¸©åº¦={data['temperature']}Â°C, "
              f"æ¹¿åº¦={data['humidity']}%, "
              f"æ°—åœ§={data['pressure']}hPa")

        time.sleep(2)
except KeyboardInterrupt:
    client.disconnect()
```

**sensor_dashboard.py**:
```python
import paho.mqtt.client as mqtt
import json

def on_message(client, userdata, msg):
    data = json.loads(msg.payload.decode())

    temp = data['temperature']
    humid = data['humidity']
    press = data['pressure']

    print("\n" + "=" * 50)
    print("ğŸ“Š ã‚»ãƒ³ã‚µãƒ¼ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰")
    print("=" * 50)
    print(f"ğŸŒ¡ï¸  æ¸©åº¦: {temp}Â°C")
    print(f"ğŸ’§ æ¹¿åº¦: {humid}%")
    print(f"ğŸŒ¤ï¸  æ°—åœ§: {press}hPa")

    # å¿«é©åº¦ã‚’åˆ¤å®š
    if 22 <= temp <= 26 and 40 <= humid <= 60:
        print("ğŸ˜Š å¿«é©ãªç’°å¢ƒã§ã™ï¼")
    else:
        print("âš ï¸ ç’°å¢ƒã‚’èª¿æ•´ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™")

def on_connect(client, userdata, flags, rc):
    print("ğŸ“¡ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰èµ·å‹•")
    client.subscribe("sensors/data")

client = mqtt.Client()
client.on_connect = on_connect
client.on_message = on_message
client.connect("localhost", 1883, 60)
client.loop_forever()
```

---

## ğŸ¯ ã¾ã¨ã‚

ã“ã‚Œã‚‰ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’è©¦ã™ã“ã¨ã§ï¼š

âœ… **å®Ÿè·µçš„ãªMQTTé€šä¿¡**ã‚’ä½“é¨“ã§ãã‚‹
âœ… **JSONãƒ‡ãƒ¼ã‚¿**ã®é€å—ä¿¡æ–¹æ³•ãŒåˆ†ã‹ã‚‹
âœ… **ãƒãƒ«ãƒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ**ã®ä»•çµ„ã¿ãŒç†è§£ã§ãã‚‹
âœ… **æ¥½ã—ã¿ãªãŒã‚‰**ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚¹ã‚­ãƒ«ãŒå‘ä¸Šã™ã‚‹

ã©ã‚“ã©ã‚“æ”¹é€ ã—ã¦ã€è‡ªåˆ†ã ã‘ã®MQTTã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼ğŸš€
