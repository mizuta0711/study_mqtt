# ç¬¬3ç«  ç†è§£åº¦ç¢ºèªãƒ†ã‚¹ãƒˆ
## Pythonã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä½œæˆ

## ğŸ“‹ ãƒ†ã‚¹ãƒˆå•é¡Œï¼ˆå…¨10å•ï¼‰

---

### å•é¡Œ1ï¼špaho-mqttã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆè¨˜è¿°å¼ï¼‰

paho-mqttãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚

**å›ç­”æ¬„**:
```bash


```

---

### å•é¡Œ2ï¼šåŸºæœ¬çš„ãªPublisherï¼ˆå®Ÿè£…å•é¡Œï¼‰

ä»¥ä¸‹ã®è¦ä»¶ã‚’æº€ãŸã™Publisherã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ï¼š
- ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼: localhost:1883
- ãƒˆãƒ”ãƒƒã‚¯: `test/message`
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: "Hello MQTT!"

**å›ç­”æ¬„**:
```python




```

---

### å•é¡Œ3ï¼šã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ï¼ˆé¸æŠå¼ï¼‰

ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã—ãŸã¨ãã«è‡ªå‹•çš„ã«å‘¼ã°ã‚Œã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ

A) `on_connect()`
B) `on_message()`
C) `on_publish()`
D) `on_subscribe()`

---

### å•é¡Œ4ï¼šãƒ«ãƒ¼ãƒ—å‡¦ç†ï¼ˆãƒãƒƒãƒãƒ³ã‚°ï¼‰

ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ—å‡¦ç†ã‚’æ­£ã—ãçµã³ä»˜ã‘ã¦ãã ã•ã„ã€‚

1. `loop_forever()`
2. `loop_start()`
3. `loop()`

A) 1å›ã ã‘ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã‚’å®Ÿè¡Œ
B) æ°¸é ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’å¾…ã¡ç¶šã‘ã‚‹
C) ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã‚’é–‹å§‹

**å›ç­”**:
- 1 â†’ ____
- 2 â†’ ____
- 3 â†’ ____

---

### å•é¡Œ5ï¼šSubscriberå®Ÿè£…ï¼ˆå®Ÿè£…å•é¡Œï¼‰

ä»¥ä¸‹ã®è¦ä»¶ã‚’æº€ãŸã™Subscriberã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ï¼š
- ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼: localhost:1883
- ãƒˆãƒ”ãƒƒã‚¯: `sensor/temperature`
- å—ä¿¡ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”»é¢ã«è¡¨ç¤º

**å›ç­”æ¬„**:
```python








```

---

### å•é¡Œ6ï¼šãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰è³¼èª­ï¼ˆè¨˜è¿°å¼ï¼‰

`home/`é…ä¸‹ã®ã™ã¹ã¦ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’è³¼èª­ã™ã‚‹ã«ã¯ã€ã©ã®ã‚ˆã†ãªãƒˆãƒ”ãƒƒã‚¯ã‚’æŒ‡å®šã™ã‚Œã°ã‚ˆã„ã§ã™ã‹ï¼Ÿ

**å›ç­”æ¬„**: ____________________________

---

### å•é¡Œ7ï¼šæ¥ç¶šç¢ºèªï¼ˆæ­£èª¤å•é¡Œï¼‰

ä»¥ä¸‹ã®æ–‡ç« ãŒæ­£ã—ã‘ã‚Œã°â—‹ã€é–“é•ã£ã¦ã„ã‚Œã°Ã—ã‚’ä»˜ã‘ã¦ãã ã•ã„ã€‚

1. `Client()`ã®å¼•æ•°ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã‚’æŒ‡å®šã§ãã‚‹ï¼ˆã€€ï¼‰
2. `on_connect()`ã®`rc`ãŒ0ãªã‚‰æ¥ç¶šæˆåŠŸï¼ˆã€€ï¼‰
3. `publish()`ã¯å¿…ãšãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€ä¿¡ã•ã‚ŒãŸã“ã¨ã‚’ä¿è¨¼ã™ã‚‹ï¼ˆã€€ï¼‰
4. `loop_forever()`ã‚’ä½¿ã†ã¨ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯çµ‚äº†ã—ãªã„ï¼ˆã€€ï¼‰

---

### å•é¡Œ8ï¼šã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆè¨˜è¿°å¼ï¼‰

ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã«æ¥ç¶šã§ããªã‹ã£ãŸå ´åˆã€`on_connect()`ã®`rc`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã¯ã©ã®ã‚ˆã†ãªå€¤ãŒå…¥ã‚Šã¾ã™ã‹ï¼Ÿ

**å›ç­”æ¬„**: ____________________________

---

### å•é¡Œ9ï¼šè¤‡æ•°ãƒˆãƒ”ãƒƒã‚¯è³¼èª­ï¼ˆå®Ÿè£…å•é¡Œï¼‰

ä»¥ä¸‹ã®ã™ã¹ã¦ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’è³¼èª­ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ï¼š
- `sensor/temperature`
- `sensor/humidity`
- `sensor/pressure`

**å›ç­”æ¬„**:
```python



```

---

### å•é¡Œ10ï¼šç·åˆå•é¡Œï¼ˆã‚·ãƒŠãƒªã‚ªå•é¡Œï¼‰

æ¸©åº¦ã‚»ãƒ³ã‚µãƒ¼ãŒ1ç§’ã”ã¨ã«ãƒ©ãƒ³ãƒ€ãƒ ãªæ¸©åº¦ï¼ˆ20.0ã€œ30.0â„ƒï¼‰ã‚’é€ä¿¡ã—ã€ãã‚Œã‚’å—ä¿¡ã—ã¦è¡¨ç¤ºã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œã‚ŠãŸã„ã€‚

ä»¥ä¸‹ã®2ã¤ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Œæˆã•ã›ã¦ãã ã•ã„ã€‚

**temperature_sensor.py**:
```python
import paho.mqtt.client as mqtt
import random
import time

# ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 







```

**temperature_monitor.py**:
```python
import paho.mqtt.client as mqtt

# ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 








```

---
---

## âœ… è§£ç­”ã¨è§£èª¬

### å•é¡Œ1ã®è§£ç­”

```bash
pip install paho-mqtt
```

ã¾ãŸã¯

```bash
pip3 install paho-mqtt
```

**è§£èª¬**:
pipã¯Pythonã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚Python 3ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯`pip3`ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚

---

### å•é¡Œ2ã®è§£ç­”

```python
import paho.mqtt.client as mqtt

client = mqtt.Client()
client.connect("localhost", 1883, 60)
client.publish("test/message", "Hello MQTT!")
client.disconnect()
```

**è§£èª¬**:
1. `Client()`ã§MQTTã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½œæˆ
2. `connect()`ã§ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã«æ¥ç¶š
3. `publish()`ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
4. `disconnect()`ã§åˆ‡æ–­

**ãƒã‚¤ãƒ³ãƒˆ**: `connect()`ã®ç¬¬3å¼•æ•°ï¼ˆ60ï¼‰ã¯ã‚­ãƒ¼ãƒ—ã‚¢ãƒ©ã‚¤ãƒ–æ™‚é–“ï¼ˆç§’ï¼‰ã§ã™ã€‚

---

### å•é¡Œ3ã®è§£ç­”

**æ­£è§£: B**

**ç†ç”±**:
`on_message()`ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã—ãŸã¨ãã«è‡ªå‹•çš„ã«å‘¼ã°ã‚Œã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã§ã™ã€‚

**ãã®ä»–ã®é¸æŠè‚¢**:
- A: `on_connect()` - ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã«æ¥ç¶šã—ãŸã¨ã
- C: `on_publish()` - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡å®Œäº†æ™‚
- D: `on_subscribe()` - è³¼èª­æˆåŠŸæ™‚

---

### å•é¡Œ4ã®è§£ç­”

**æ­£è§£**:
- 1 â†’ **B** ï¼ˆæ°¸é ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’å¾…ã¡ç¶šã‘ã‚‹ï¼‰
- 2 â†’ **C** ï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã‚’é–‹å§‹ï¼‰
- 3 â†’ **A** ï¼ˆ1å›ã ã‘ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã‚’å®Ÿè¡Œï¼‰

**è©³ç´°èª¬æ˜**:

**`loop_forever()`**:
- Subscriberãªã©ã§å¸¸æ™‚å¾…æ©Ÿã™ã‚‹å ´åˆã«ä½¿ç”¨
- Ctrl+Cã§çµ‚äº†

**`loop_start()`**:
- ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§åˆ¥ã®å‡¦ç†ã‚’ã—ãªãŒã‚‰ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã—ãŸã„å ´åˆ
- `loop_stop()`ã§åœæ­¢

**`loop()`**:
- ç´°ã‹ã„åˆ¶å¾¡ãŒå¿…è¦ãªå ´åˆ
- é€šå¸¸ã¯forãƒ«ãƒ¼ãƒ—ã®ä¸­ã§å‘¼ã¶

---

### å•é¡Œ5ã®è§£ç­”

```python
import paho.mqtt.client as mqtt

def on_message(client, userdata, msg):
    temperature = msg.payload.decode()
    print(f"å—ä¿¡ã—ãŸæ¸©åº¦: {temperature}Â°C")

def on_connect(client, userdata, flags, rc):
    if rc == 0:
        client.subscribe("sensor/temperature")

client = mqtt.Client()
client.on_connect = on_connect
client.on_message = on_message
client.connect("localhost", 1883, 60)
client.loop_forever()
```

**è§£èª¬**:
1. `on_message()`ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡æ™‚ã®å‡¦ç†ã‚’å®šç¾©
2. `on_connect()`ã§æ¥ç¶šæˆåŠŸæ™‚ã«è³¼èª­ã‚’é–‹å§‹
3. ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã‚’ç™»éŒ²
4. `loop_forever()`ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’å¾…ã¡ç¶šã‘ã‚‹

**é‡è¦**: `decode()`ã§ãƒã‚¤ãƒˆåˆ—ã‚’æ–‡å­—åˆ—ã«å¤‰æ›ã—ã¾ã™ã€‚

---

### å•é¡Œ6ã®è§£ç­”

**æ­£è§£**: `home/#`

**ç†ç”±**:
`#`ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã¯ã€ãã®éšå±¤ä»¥ä¸‹ã®ã™ã¹ã¦ã®ãƒˆãƒ”ãƒƒã‚¯ã«ãƒãƒƒãƒã—ã¾ã™ã€‚

**ä¾‹**:
- `home/livingroom/temperature` â†’ ãƒãƒƒãƒ
- `home/bedroom/humidity` â†’ ãƒãƒƒãƒ
- `home/kitchen/light/status` â†’ ãƒãƒƒãƒ

**è£œè¶³**: `+`ã¯1éšå±¤ã®ã¿ãƒãƒƒãƒï¼ˆä¾‹ï¼š`home/+/temperature`ï¼‰

---

### å•é¡Œ7ã®è§£ç­”

**æ­£è§£**:
1. â—‹ **æ­£ã—ã„**
2. â—‹ **æ­£ã—ã„**
3. Ã— **é–“é•ã„**
4. â—‹ **æ­£ã—ã„**

**è§£èª¬**:

**1. `Client()`ã®å¼•æ•°ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã‚’æŒ‡å®šã§ãã‚‹**
- âœ… æ­£ã—ã„
```python
client = mqtt.Client("MyClient01")
```

**2. `on_connect()`ã®`rc`ãŒ0ãªã‚‰æ¥ç¶šæˆåŠŸ**
- âœ… æ­£ã—ã„
- rc=0: æˆåŠŸ
- rcâ‰ 0: ã‚¨ãƒ©ãƒ¼

**3. `publish()`ã¯å¿…ãšãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€ä¿¡ã•ã‚ŒãŸã“ã¨ã‚’ä¿è¨¼ã™ã‚‹**
- âŒ é–“é•ã„
- QoS 0ã§ã¯é…ä¿¡ä¿è¨¼ãŒã‚ã‚Šã¾ã›ã‚“
- QoS 1/2ã§ä¿è¨¼ã•ã‚Œã¾ã™

**4. `loop_forever()`ã‚’ä½¿ã†ã¨ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯çµ‚äº†ã—ãªã„**
- âœ… æ­£ã—ã„
- Ctrl+Cã¾ãŸã¯`disconnect()`ã§çµ‚äº†

---

### å•é¡Œ8ã®è§£ç­”

**æ­£è§£**: 0ä»¥å¤–ã®å€¤ï¼ˆ1ã€œ5ï¼‰

**rcã®å€¤ã®æ„å‘³**:
| rc | æ„å‘³ |
|:---:|:---|
| 0 | æ¥ç¶šæˆåŠŸ |
| 1 | ä¸æ­£ãªãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
| 2 | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDãŒæ‹’å¦ã•ã‚ŒãŸ |
| 3 | ã‚µãƒ¼ãƒãƒ¼ãŒåˆ©ç”¨ã§ããªã„ |
| 4 | ãƒ¦ãƒ¼ã‚¶ãƒ¼å/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã‚‹ |
| 5 | èªè¨¼ã•ã‚Œã¦ã„ãªã„ |

**ç¢ºèªæ–¹æ³•**:
```python
def on_connect(client, userdata, flags, rc):
    if rc == 0:
        print("æ¥ç¶šæˆåŠŸ")
    else:
        print(f"æ¥ç¶šå¤±æ•—: rc={rc}")
```

---

### å•é¡Œ9ã®è§£ç­”

**æ–¹æ³•1: è¤‡æ•°å›subscribe()ã‚’å‘¼ã¶**
```python
client.subscribe("sensor/temperature")
client.subscribe("sensor/humidity")
client.subscribe("sensor/pressure")
```

**æ–¹æ³•2: ãƒªã‚¹ãƒˆã§æŒ‡å®š**
```python
topics = [
    ("sensor/temperature", 0),
    ("sensor/humidity", 0),
    ("sensor/pressure", 0)
]
client.subscribe(topics)
```

**æ–¹æ³•3: ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ã†ï¼ˆæ¨å¥¨ï¼‰**
```python
client.subscribe("sensor/#")
```

**è§£èª¬**:
ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ã†ã®ãŒæœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§æ‹¡å¼µæ€§ãŒã‚ã‚Šã¾ã™ã€‚`sensor/`é…ä¸‹ã®ã™ã¹ã¦ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’è³¼èª­ã§ãã¾ã™ã€‚

---

### å•é¡Œ10ã®è§£ç­”

**temperature_sensor.py**:
```python
import paho.mqtt.client as mqtt
import random
import time

BROKER = "localhost"
PORT = 1883
TOPIC = "sensor/temperature"

client = mqtt.Client()
client.connect(BROKER, PORT, 60)

print("ğŸŒ¡ï¸  æ¸©åº¦ã‚»ãƒ³ã‚µãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿èµ·å‹•")

try:
    while True:
        temperature = round(random.uniform(20.0, 30.0), 1)
        client.publish(TOPIC, str(temperature))
        print(f"ğŸ“¤ é€ä¿¡: {temperature}Â°C")
        time.sleep(1)
except KeyboardInterrupt:
    print("\nğŸ‘‹ åœæ­¢ã—ã¾ã—ãŸ")
    client.disconnect()
```

**temperature_monitor.py**:
```python
import paho.mqtt.client as mqtt

BROKER = "localhost"
PORT = 1883
TOPIC = "sensor/temperature"

def on_message(client, userdata, msg):
    temperature = float(msg.payload.decode())
    print(f"ğŸŒ¡ï¸  ç¾åœ¨ã®æ¸©åº¦: {temperature}Â°C")

def on_connect(client, userdata, flags, rc):
    if rc == 0:
        print("ğŸ“¡ æ¸©åº¦ãƒ¢ãƒ‹ã‚¿ãƒ¼èµ·å‹•")
        client.subscribe(TOPIC)

client = mqtt.Client()
client.on_connect = on_connect
client.on_message = on_message
client.connect(BROKER, PORT, 60)

print("â³ ãƒ‡ãƒ¼ã‚¿ã‚’å¾…ã£ã¦ã„ã¾ã™...")
client.loop_forever()
```

**å®Ÿè¡Œæ–¹æ³•**:
1. ã‚¿ãƒ¼ãƒŸãƒŠãƒ«1ã§ `python temperature_monitor.py`
2. ã‚¿ãƒ¼ãƒŸãƒŠãƒ«2ã§ `python temperature_sensor.py`

**æ¡ç‚¹åŸºæº–**:
- [ ] `random.uniform()`ã§æ¸©åº¦ã‚’ç”Ÿæˆ
- [ ] `while True`ã§ç„¡é™ãƒ«ãƒ¼ãƒ—
- [ ] `time.sleep(1)`ã§1ç§’å¾…æ©Ÿ
- [ ] Subscriberã§`on_message()`ã‚’å®Ÿè£…
- [ ] `float()`ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ•°å€¤ã«å¤‰æ›

**ãƒã‚¤ãƒ³ãƒˆ**:
- ã‚»ãƒ³ã‚µãƒ¼å´: `str(temperature)`ã§æ–‡å­—åˆ—ã«å¤‰æ›ã—ã¦é€ä¿¡
- ãƒ¢ãƒ‹ã‚¿ãƒ¼å´: `float(msg.payload.decode())`ã§æ•°å€¤ã«å¤‰æ›

---

## ğŸ¯ æ¡ç‚¹åŸºæº–

- **8å•ä»¥ä¸Šæ­£è§£**: âœ… å„ªç§€ï¼æ¬¡ã®ç« ã«é€²ã‚ã¾ã™
- **6ã€œ7å•æ­£è§£**: â–³ åŸºæœ¬ã¯ç†è§£ã§ãã¦ã„ã¾ã™ã€‚é–“é•ãˆãŸéƒ¨åˆ†ã‚’å¾©ç¿’ã—ã¾ã—ã‚‡ã†
- **5å•ä»¥ä¸‹**: âš ï¸ ã‚‚ã†ä¸€åº¦ã€ãƒ¡ã‚¤ãƒ³ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã¿ç›´ã™ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™

---

## ğŸ“ ã‚ˆãã‚ã‚‹é–“é•ã„

| ã‚ˆãã‚ã‚‹é–“é•ã„ | æ­£ã—ã„ç†è§£ |
|:---|:---|
| `decode()`ã‚’å¿˜ã‚Œã‚‹ | `msg.payload`ã¯ãƒã‚¤ãƒˆåˆ—ãªã®ã§å¿…ãš`decode()`ãŒå¿…è¦ |
| `loop_forever()`ã®å‰ã«`subscribe()` | `on_connect()`å†…ã§`subscribe()`ã™ã‚‹ã®ãŒå®‰å…¨ |
| ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã®é‡è¤‡ | åŒã˜IDã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯æ’ä»–çš„ï¼ˆå¾Œã‹ã‚‰æ¥ç¶šã—ãŸæ–¹ãŒå„ªå…ˆï¼‰ |
| `publish()`å¾Œã™ã`disconnect()` | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å‡¦ç†ãŒå®Œäº†ã™ã‚‹å‰ã«åˆ‡æ–­ã•ã‚Œã‚‹å¯èƒ½æ€§ã‚ã‚Š |

---

## ğŸ”„ å¾©ç¿’ã®ãƒã‚¤ãƒ³ãƒˆ

### ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã®æµã‚Œ

```
1. connect()ã‚’å‘¼ã¶
   â†“
2. on_connect()ãŒè‡ªå‹•å®Ÿè¡Œ
   â†“
3. subscribe()ã‚’å‘¼ã¶
   â†“
4. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡
   â†“
5. on_message()ãŒè‡ªå‹•å®Ÿè¡Œ
```

### Publisherã®åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³

```python
client = mqtt.Client()
client.connect(BROKER, PORT, 60)
client.publish(TOPIC, MESSAGE)
client.disconnect()
```

### Subscriberã®åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³

```python
def on_message(client, userdata, msg):
    print(msg.payload.decode())

client = mqtt.Client()
client.on_message = on_message
client.connect(BROKER, PORT, 60)
client.subscribe(TOPIC)
client.loop_forever()
```

---

**ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼**
åŸºæœ¬ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ãŸã‚‰ã€æ¬¡ã¯é«˜åº¦ãªæ©Ÿèƒ½ã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼

**æ¬¡ã®ç« **: [ç¬¬4ç« ï¼šQoSãƒ»Retainãƒ»Willã‚’è©¦ã™](../step4/01_MQTTæ©Ÿèƒ½å®Ÿè·µ.md)
